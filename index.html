<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.1/lodash.min.js"></script>
        <title>Fractal-and-PPM</title>
    </head>
    <style type="text/css">
      body {
        width:100%;
        height:100vh;
      }
      canvas{
        border-style: outset;
        border-width: 5px;
        width: 400px;
        height: 400px;
      }
    </style>
    <body>
      <a href="https://github.com/yongxu/Fractal-and-PPM"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"></a>
      <form>
        <section>
          <p>imsize</p>
          <p>
            <label for="number">
              <span>width:</span>
              <input type="text" id="width" value="400" required />
            </label>
          </p>
          <p>
            <label for="number">
              <span>height:</span>
              <input type="text" id="height" value="400" required />
            </label>
          </p>
        </section>

        <section>
          <p>
            <span>click to draw canvas with imsize width height:</span>
            <button type="submit" id="draw">draw</button>
          </p>
        </section>

      </form>
      <canvas id="canvas"></canvas >
      <script type="text/javascript">
        (function(){
          var canvas = document.getElementById('canvas');
          var width = document.getElementById('width');
          var height = document.getElementById('height');
          var drawButton = document.getElementById('draw');
          var ctx = canvas.getContext('2d');

          function draw(width,height){
            //erase canvas
            ctx.clearRect(0,0, canvas.width, canvas.height);
            var halfWidth = width/2;
            var halfHeight = height/2;
            var ratio = width/height;
            // let shorter edge bounded by -1 and 1
            var scale = ratio<1 ? halfWidth : halfHeight;
            //transform coordinate, y points up, origin at center
            function Tx(x){
              return x * scale + halfWidth;
            }
            function Ty(y){
              return halfHeight - y * scale;
            }

            ctx.fillRect(Tx(0),Ty(0),Tx(0.5),Ty(0.9));
          }

          function generatePPM(){
            var bitmap = ctx.getImageData(0, 0, canvas.width, canvas.height);

          }

          function update(e){
            e.preventDefault();
            if(width.value && height.value){
              canvas.width = width.value;
              canvas.height = height.value;
              draw(canvas.width,canvas.height);
              generatePPM();
            }
          }

          drawButton.addEventListener("click", update);

        })();
      </script>
    </body>
</html>
